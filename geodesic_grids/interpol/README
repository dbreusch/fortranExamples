

this code is documented in driver.f90, please read it.
